y = q5_urb_m,
xend = 3,
yend =q5_urb_f,  color="darkorange1") +
geom_segment(x = 3.5,  #v line 3rd level 2nd
y = q5_rur_m,
xend = 3.5,
yend =q5_rur_f, color="darkmagenta") +
geom_segment(x = 3,  #v line 3rd level 4th
y = q1_urb_m,
xend = 3,
yend =q1_urb_f, color="limegreen") +
geom_segment(x = 3.5,  #v line 3rd level 4th
y = q1_rur_m,
xend = 3.5,
yend =q1_rur_f, color="dodgerblue3") +
geom_segment(x = 1,  #horizontal 1-2 up
y = q5,
xend = 2,
yend =q5) +
geom_segment(x = 2,  #horizontal 2-3 1st
y = q5_urb,
xend = 3,
yend =q5_urb, color="darkorange1") +
geom_segment(x = 2,
y = q5_rur,  #horizontal 2-3 2nd
xend = 3.5,
yend =q5_rur, color="darkmagenta")+
geom_segment(x = 1, #horizontal 1-2 down
y = q1,
xend = 2,
yend =q1)+
geom_segment(x = 2,
y = q1_urb,  #horizontal 2-3 3rd
xend = 3,
yend =q1_urb, color="limegreen")+
geom_segment(x = 2,
y = q1_rur,  #horizontal 2-3 4th
xend = 3.5,
yend =q1_rur, color="dodgerblue3")+
theme(panel.background = element_rect(fill = "gray93",
colour = "gray93",
size = 0.5, linetype = "solid"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())   +
scale_y_continuous(limits = c(0, 1))+
scale_x_continuous(n.breaks = 4, label = c("Wealth", "Location", "Sex", "Sex")) +
labs(y= "Primary completion", x="") +
geom_label_repel(aes(label = short_labels),
box.padding   = 0.95,
point.padding = 0.5,
segment.color = 'grey50')
accessg
plot_data  <- data.frame(level = c(1, 1, 2, 2, 2, 2, 3, 3, 3.5, 3.5, 3, 3, 3.5, 3.5),                      # Create example data frame
indicator = c(q1, q5, q5_urb, q5_rur, q1_urb, q1_rur, q5_urb_m, q5_urb_f, q5_rur_m, q5_rur_f, q1_urb_m, q1_urb_f, q1_rur_m, q1_rur_f),
ind_example = c(60, 95, 90, 96, 61, 50, 98, 95, 80, 90, 51, 49, 65, 58),
full_labels = c("Poorest","Richest", "Richest urban","Richest rural", "Poorest urban","Poorest rural",
"Richest urban men", "Richest urban women", "Richest rural men", "Richest rural women",
"Poorest urban men", "Poorest urban women" , "Poorest rural men", "Poorest rural women"),
# short_labels= c("Poorest","Richest", "Urban","Rural", "Urban","Rural",
#                 "Men", "Women", "Men", "Women",
#                 "Men", "Women" , "Men", "Women"),
short_labels= c("Poorest","Richest", "Urban","Rural", "Urban","Rural",
"Men", "Women", "Men", "Women",
"Men", "Women" , "Men", "Women"),
colors= c("black","black", "black","black", "black","black",
"darkorange1", "darkorange1", "darkmagenta", "darkmagenta",
"limegreen", "limegreen" , "dodgerblue3", "dodgerblue3"))
#WEALTH-LOCATION-SEX
ggp <- ggplot(plot_data, aes(level, indicator, label=short_labels), colour=short_labels) +                 # Create ggplot2 plot without lines & curves
geom_point(colour=plot_data$colors)
ggp
accessg <-   ggp+
geom_segment(x = 1, #v line at level 1
y = q1,
xend = 1,
yend =q5) +
geom_segment(x = 2, #v line upper
y = q5_urb,
xend = 2,
yend =q5_rur) +
geom_segment(x = 2,
y = q1_urb,   #v line down
xend = 2,
yend =q1_rur)  +
geom_segment(x = 3,    #v line 3rd level 1st
y = q5_urb_m,
xend = 3,
yend =q5_urb_f,  color="darkorange1") +
geom_segment(x = 3.5,  #v line 3rd level 2nd
y = q5_rur_m,
xend = 3.5,
yend =q5_rur_f, color="darkmagenta") +
geom_segment(x = 3,  #v line 3rd level 4th
y = q1_urb_m,
xend = 3,
yend =q1_urb_f, color="limegreen") +
geom_segment(x = 3.5,  #v line 3rd level 4th
y = q1_rur_m,
xend = 3.5,
yend =q1_rur_f, color="dodgerblue3") +
geom_segment(x = 1,  #horizontal 1-2 up
y = q5,
xend = 2,
yend =q5) +
geom_segment(x = 2,  #horizontal 2-3 1st
y = q5_urb,
xend = 3,
yend =q5_urb, color="darkorange1") +
geom_segment(x = 2,
y = q5_rur,  #horizontal 2-3 2nd
xend = 3.5,
yend =q5_rur, color="darkmagenta")+
geom_segment(x = 1, #horizontal 1-2 down
y = q1,
xend = 2,
yend =q1)+
geom_segment(x = 2,
y = q1_urb,  #horizontal 2-3 3rd
xend = 3,
yend =q1_urb, color="limegreen")+
geom_segment(x = 2,
y = q1_rur,  #horizontal 2-3 4th
xend = 3.5,
yend =q1_rur, color="dodgerblue3")+
theme(panel.background = element_rect(fill = "gray93",
colour = "gray93",
size = 0.5, linetype = "solid"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())   +
scale_y_continuous(limits = c(0, 1))+
scale_x_continuous(n.breaks = 4, label = c("Wealth", "Location", "Sex", "Sex")) +
labs(y= "Primary completion", x="") +
geom_label_repel(aes(label = short_labels),
box.padding   = 0.95,
point.padding = 0.5,
segment.color = 'grey50')
accessg
#select survey
extracted_survey <- WIDE_2023_08_02 %>% filter(iso_code=="BGD" & survey=='MICS' & year==2019 & is.na(level))
rm(q1, q5, q5_urb, q5_rur, q1_urb, q1_rur, q5_urb_f, q5_urb_m,  q5_rur_f, q5_rur_m, q1_urb_f, q1_urb_m, q1_rur_f, q1_rur_m)
indicator <- 'comp_prim_v2_m'
q1 <- extracted_survey %>% filter(category=="Wealth") %>% filter(wealth %in% c('Quintile 1')) %>% pull(indicator)
q5 <- extracted_survey %>% filter(category=="Wealth") %>% filter(wealth %in% c('Quintile 5')) %>% pull(indicator)
q5_urb <- extracted_survey %>% filter(category=="Location & Wealth") %>% filter(wealth %in% c('Quintile 5') & location %in% c('Urban')) %>% pull(indicator)
q5_rur <- extracted_survey %>% filter(category=="Location & Wealth") %>% filter(wealth %in% c('Quintile 4') & location %in% c('Rural')) %>% pull(indicator)
q1_urb <- extracted_survey %>% filter(category=="Location & Wealth") %>% filter(wealth %in% c('Quintile 1') & location %in% c('Urban')) %>% pull(indicator)
q1_rur <- extracted_survey %>% filter(category=="Location & Wealth") %>% filter(wealth %in% c('Quintile 1') & location %in% c('Rural')) %>% pull(indicator)
q5_urb_f <- extracted_survey %>% filter(category=="Location & Sex & Wealth") %>%
filter(wealth %in% c('Quintile 5') & location %in% c('Urban') & sex %in% c('Female')) %>% pull(indicator)
q5_urb_m <- extracted_survey %>% filter(category=="Location & Sex & Wealth") %>%
filter(wealth %in% c('Quintile 5') & location %in% c('Urban') & sex %in% c('Male')) %>% pull(indicator)
q5_rur_f <- extracted_survey %>% filter(category=="Location & Sex & Wealth") %>%
filter(wealth %in% c('Quintile 5') & location %in% c('Rural') & sex %in% c('Female')) %>% pull(indicator)
q5_rur_m <- extracted_survey %>% filter(category=="Location & Sex & Wealth") %>%
filter(wealth %in% c('Quintile 5') & location %in% c('Rural') & sex %in% c('Male')) %>% pull(indicator)
q1_urb_f <- extracted_survey %>% filter(category=="Location & Sex & Wealth") %>%
filter(wealth %in% c('Quintile 1') & location %in% c('Urban') & sex %in% c('Female')) %>% pull(indicator)
q1_urb_m <- extracted_survey %>% filter(category=="Location & Sex & Wealth") %>%
filter(wealth %in% c('Quintile 1') & location %in% c('Urban') & sex %in% c('Male')) %>% pull(indicator)
q1_rur_f <- extracted_survey %>% filter(category=="Location & Sex & Wealth") %>%
filter(wealth %in% c('Quintile 1') & location %in% c('Rural') & sex %in% c('Female')) %>% pull(indicator)
q1_rur_m <- extracted_survey %>% filter(category=="Location & Sex & Wealth") %>%
filter(wealth %in% c('Quintile 1') & location %in% c('Rural') & sex %in% c('Male')) %>% pull(indicator)
plot_data  <- data.frame(level = c(1, 1, 2, 2, 2, 2, 3, 3, 3.5, 3.5, 3, 3, 3.5, 3.5),                      # Create example data frame
indicator = c(q1, q5, q5_urb, q5_rur, q1_urb, q1_rur, q5_urb_m, q5_urb_f, q5_rur_m, q5_rur_f, q1_urb_m, q1_urb_f, q1_rur_m, q1_rur_f),
ind_example = c(60, 95, 90, 96, 61, 50, 98, 95, 80, 90, 51, 49, 65, 58),
full_labels = c("Poorest","Richest", "Richest urban","Richest rural", "Poorest urban","Poorest rural",
"Richest urban men", "Richest urban women", "Richest rural men", "Richest rural women",
"Poorest urban men", "Poorest urban women" , "Poorest rural men", "Poorest rural women"),
# short_labels= c("Poorest","Richest", "Urban","Rural", "Urban","Rural",
#                 "Men", "Women", "Men", "Women",
#                 "Men", "Women" , "Men", "Women"),
short_labels= c("Poorest","Richest", "Urban","Rural", "Urban","Rural",
"Men", "Women", "Men", "Women",
"Men", "Women" , "Men", "Women"),
colors= c("black","black", "black","black", "black","black",
"darkorange1", "darkorange1", "darkmagenta", "darkmagenta",
"limegreen", "limegreen" , "dodgerblue3", "dodgerblue3"))
#WEALTH-LOCATION-SEX
ggp <- ggplot(plot_data, aes(level, indicator, label=short_labels), colour=short_labels) +                 # Create ggplot2 plot without lines & curves
geom_point(colour=plot_data$colors)
ggp
accessg <-   ggp+
geom_segment(x = 1, #v line at level 1
y = q1,
xend = 1,
yend =q5) +
geom_segment(x = 2, #v line upper
y = q5_urb,
xend = 2,
yend =q5_rur) +
geom_segment(x = 2,
y = q1_urb,   #v line down
xend = 2,
yend =q1_rur)  +
geom_segment(x = 3,    #v line 3rd level 1st
y = q5_urb_m,
xend = 3,
yend =q5_urb_f,  color="darkorange1") +
geom_segment(x = 3.5,  #v line 3rd level 2nd
y = q5_rur_m,
xend = 3.5,
yend =q5_rur_f, color="darkmagenta") +
geom_segment(x = 3,  #v line 3rd level 4th
y = q1_urb_m,
xend = 3,
yend =q1_urb_f, color="limegreen") +
geom_segment(x = 3.5,  #v line 3rd level 4th
y = q1_rur_m,
xend = 3.5,
yend =q1_rur_f, color="dodgerblue3") +
geom_segment(x = 1,  #horizontal 1-2 up
y = q5,
xend = 2,
yend =q5) +
geom_segment(x = 2,  #horizontal 2-3 1st
y = q5_urb,
xend = 3,
yend =q5_urb, color="darkorange1") +
geom_segment(x = 2,
y = q5_rur,  #horizontal 2-3 2nd
xend = 3.5,
yend =q5_rur, color="darkmagenta")+
geom_segment(x = 1, #horizontal 1-2 down
y = q1,
xend = 2,
yend =q1)+
geom_segment(x = 2,
y = q1_urb,  #horizontal 2-3 3rd
xend = 3,
yend =q1_urb, color="limegreen")+
geom_segment(x = 2,
y = q1_rur,  #horizontal 2-3 4th
xend = 3.5,
yend =q1_rur, color="dodgerblue3")+
theme(panel.background = element_rect(fill = "gray93",
colour = "gray93",
size = 0.5, linetype = "solid"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())   +
scale_y_continuous(limits = c(0, 1))+
scale_x_continuous(n.breaks = 4, label = c("Wealth", "Location", "Sex", "Sex")) +
labs(y= "Primary completion", x="") +
geom_label_repel(aes(label = short_labels),
box.padding   = 0.95,
point.padding = 0.5,
segment.color = 'grey50')
accessg
View(extracted_survey)
#select survey
extracted_survey <- WIDE_2023_08_02 %>% filter(iso_code=="BGD" & survey=='MICS' & year==2019 & is.na(level))
indicator <- 'comp_prim_v2_m'
#select survey
extracted_survey <- WIDE_2023_08_02 %>% filter(iso_code=="BGD" & survey=='MICS' & year==2019 )
q1 <- extracted_survey %>% filter(category=="Wealth") %>% filter(wealth %in% c('Quintile 1')) %>% pull(indicator)
q5 <- extracted_survey %>% filter(category=="Wealth") %>% filter(wealth %in% c('Quintile 5')) %>% pull(indicator)
q5_urb <- extracted_survey %>% filter(category=="Location & Wealth") %>% filter(wealth %in% c('Quintile 5') & location %in% c('Urban')) %>% pull(indicator)
q5_rur <- extracted_survey %>% filter(category=="Location & Wealth") %>% filter(wealth %in% c('Quintile 4') & location %in% c('Rural')) %>% pull(indicator)
q1_urb <- extracted_survey %>% filter(category=="Location & Wealth") %>% filter(wealth %in% c('Quintile 1') & location %in% c('Urban')) %>% pull(indicator)
q1_rur <- extracted_survey %>% filter(category=="Location & Wealth") %>% filter(wealth %in% c('Quintile 1') & location %in% c('Rural')) %>% pull(indicator)
q5_urb_f <- extracted_survey %>% filter(category=="Location & Sex & Wealth") %>%
filter(wealth %in% c('Quintile 5') & location %in% c('Urban') & sex %in% c('Female')) %>% pull(indicator)
q5_urb_m <- extracted_survey %>% filter(category=="Location & Sex & Wealth") %>%
filter(wealth %in% c('Quintile 5') & location %in% c('Urban') & sex %in% c('Male')) %>% pull(indicator)
q5_rur_f <- extracted_survey %>% filter(category=="Location & Sex & Wealth") %>%
filter(wealth %in% c('Quintile 5') & location %in% c('Rural') & sex %in% c('Female')) %>% pull(indicator)
q5_rur_m <- extracted_survey %>% filter(category=="Location & Sex & Wealth") %>%
filter(wealth %in% c('Quintile 5') & location %in% c('Rural') & sex %in% c('Male')) %>% pull(indicator)
#select survey
extracted_survey <- WIDE_2023_08_02 %>% filter(iso_code=="BGD" & survey=='MICS' & year==2019 & is.na(level))
indicator <- 'comp_prim_v2_m'
q1 <- extracted_survey %>% filter(category=="Wealth") %>% filter(wealth %in% c('Quintile 1')) %>% pull(indicator)
q5 <- extracted_survey %>% filter(category=="Wealth") %>% filter(wealth %in% c('Quintile 5')) %>% pull(indicator)
q5_urb <- extracted_survey %>% filter(category=="Location & Wealth") %>% filter(wealth %in% c('Quintile 5') & location %in% c('Urban')) %>% pull(indicator)
q5_rur <- extracted_survey %>% filter(category=="Location & Wealth") %>% filter(wealth %in% c('Quintile 4') & location %in% c('Rural')) %>% pull(indicator)
q1_urb <- extracted_survey %>% filter(category=="Location & Wealth") %>% filter(wealth %in% c('Quintile 1') & location %in% c('Urban')) %>% pull(indicator)
q1_rur <- extracted_survey %>% filter(category=="Location & Wealth") %>% filter(wealth %in% c('Quintile 1') & location %in% c('Rural')) %>% pull(indicator)
q5_urb_f <- extracted_survey %>% filter(category=="Location & Sex & Wealth") %>%
filter(wealth %in% c('Quintile 5') & location %in% c('Urban') & sex %in% c('Female')) %>% pull(indicator)
q5_urb_m <- extracted_survey %>% filter(category=="Location & Sex & Wealth") %>%
filter(wealth %in% c('Quintile 5') & location %in% c('Urban') & sex %in% c('Male')) %>% pull(indicator)
q5_rur_f <- extracted_survey %>% filter(category=="Location & Sex & Wealth") %>%
filter(wealth %in% c('Quintile 5') & location %in% c('Rural') & sex %in% c('Female')) %>% pull(indicator)
q5_rur_m <- extracted_survey %>% filter(category=="Location & Sex & Wealth") %>%
filter(wealth %in% c('Quintile 5') & location %in% c('Rural') & sex %in% c('Male')) %>% pull(indicator)
#q5_rur_f <- -1
#q5_rur_m <- -1
q5_urb <- 0.92
q1_urb_f <- extracted_survey %>% filter(category=="Location & Sex & Wealth") %>%
filter(wealth %in% c('Quintile 1') & location %in% c('Urban') & sex %in% c('Female')) %>% pull(indicator)
q1_urb_m <- extracted_survey %>% filter(category=="Location & Sex & Wealth") %>%
filter(wealth %in% c('Quintile 1') & location %in% c('Urban') & sex %in% c('Male')) %>% pull(indicator)
q1_rur_f <- extracted_survey %>% filter(category=="Location & Sex & Wealth") %>%
filter(wealth %in% c('Quintile 1') & location %in% c('Rural') & sex %in% c('Female')) %>% pull(indicator)
q1_rur_m <- extracted_survey %>% filter(category=="Location & Sex & Wealth") %>%
filter(wealth %in% c('Quintile 1') & location %in% c('Rural') & sex %in% c('Male')) %>% pull(indicator)
plot_data  <- data.frame(level = c(1, 1, 2, 2, 2, 2, 3, 3, 3.5, 3.5, 3, 3, 3.5, 3.5),                      # Create example data frame
indicator = c(q1, q5, q5_urb, q5_rur, q1_urb, q1_rur, q5_urb_m, q5_urb_f, q5_rur_m, q5_rur_f, q1_urb_m, q1_urb_f, q1_rur_m, q1_rur_f),
ind_example = c(60, 95, 90, 96, 61, 50, 98, 95, 80, 90, 51, 49, 65, 58),
full_labels = c("Poorest","Richest", "Richest urban","Richest rural", "Poorest urban","Poorest rural",
"Richest urban men", "Richest urban women", "Richest rural men", "Richest rural women",
"Poorest urban men", "Poorest urban women" , "Poorest rural men", "Poorest rural women"),
# short_labels= c("Poorest","Richest", "Urban","Rural", "Urban","Rural",
#                 "Men", "Women", "Men", "Women",
#                 "Men", "Women" , "Men", "Women"),
short_labels= c("Poorest","Richest", "Urban","Rural", "Urban","Rural",
"Men", "Women", "Men", "Women",
"Men", "Women" , "Men", "Women"),
colors= c("black","black", "black","black", "black","black",
"darkorange1", "darkorange1", "darkmagenta", "darkmagenta",
"limegreen", "limegreen" , "dodgerblue3", "dodgerblue3"))
#WEALTH-LOCATION-SEX
ggp <- ggplot(plot_data, aes(level, indicator, label=short_labels), colour=short_labels) +                 # Create ggplot2 plot without lines & curves
geom_point(colour=plot_data$colors)
ggp
accessg <-   ggp+
geom_segment(x = 1, #v line at level 1
y = q1,
xend = 1,
yend =q5) +
geom_segment(x = 2, #v line upper
y = q5_urb,
xend = 2,
yend =q5_rur) +
geom_segment(x = 2,
y = q1_urb,   #v line down
xend = 2,
yend =q1_rur)  +
geom_segment(x = 3,    #v line 3rd level 1st
y = q5_urb_m,
xend = 3,
yend =q5_urb_f,  color="darkorange1") +
geom_segment(x = 3.5,  #v line 3rd level 2nd
y = q5_rur_m,
xend = 3.5,
yend =q5_rur_f, color="darkmagenta") +
geom_segment(x = 3,  #v line 3rd level 4th
y = q1_urb_m,
xend = 3,
yend =q1_urb_f, color="limegreen") +
geom_segment(x = 3.5,  #v line 3rd level 4th
y = q1_rur_m,
xend = 3.5,
yend =q1_rur_f, color="dodgerblue3") +
geom_segment(x = 1,  #horizontal 1-2 up
y = q5,
xend = 2,
yend =q5) +
geom_segment(x = 2,  #horizontal 2-3 1st
y = q5_urb,
xend = 3,
yend =q5_urb, color="darkorange1") +
geom_segment(x = 2,
y = q5_rur,  #horizontal 2-3 2nd
xend = 3.5,
yend =q5_rur, color="darkmagenta")+
geom_segment(x = 1, #horizontal 1-2 down
y = q1,
xend = 2,
yend =q1)+
geom_segment(x = 2,
y = q1_urb,  #horizontal 2-3 3rd
xend = 3,
yend =q1_urb, color="limegreen")+
geom_segment(x = 2,
y = q1_rur,  #horizontal 2-3 4th
xend = 3.5,
yend =q1_rur, color="dodgerblue3")+
theme(panel.background = element_rect(fill = "gray93",
colour = "gray93",
size = 0.5, linetype = "solid"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())   +
scale_y_continuous(limits = c(0, 1))+
scale_x_continuous(n.breaks = 4, label = c("Wealth", "Location", "Sex", "Sex")) +
labs(y= "Primary completion", x="") +
geom_label_repel(aes(label = short_labels),
box.padding   = 0.95,
point.padding = 0.5,
segment.color = 'grey50')
accessg
extracted_survey <- mics_learning %>% filter(iso_code3=="BGD" & level=='end of primary')
indicator <- 'mlevel2_m'
q1 <- extracted_survey %>% filter(category=="Wealth") %>% filter(wealth %in% c('Quintile 1')) %>% pull(indicator)
q5 <- extracted_survey %>% filter(category=="Wealth") %>% filter(wealth %in% c('Quintile 5')) %>% pull(indicator)
q5_urb <- extracted_survey %>% filter(category=="Location & Wealth") %>% filter(wealth %in% c('Quintile 5') & location %in% c('Urban')) %>% pull(indicator)
q5_rur <- extracted_survey %>% filter(category=="Location & Wealth") %>% filter(wealth %in% c('Quintile 5') & location %in% c('Rural')) %>% pull(indicator)
q1_urb <- extracted_survey %>% filter(category=="Location & Wealth") %>% filter(wealth %in% c('Quintile 1') & location %in% c('Urban')) %>% pull(indicator)
q1_rur <- extracted_survey %>% filter(category=="Location & Wealth") %>% filter(wealth %in% c('Quintile 1') & location %in% c('Rural')) %>% pull(indicator)
q5_urb_f <- extracted_survey %>% filter(category=="Location & Sex & Wealth") %>%
filter(wealth %in% c('Quintile 5') & location %in% c('Urban') & sex %in% c('Female')) %>% pull(indicator)
q5_urb_m <- extracted_survey %>% filter(category=="Location & Sex & Wealth") %>%
filter(wealth %in% c('Quintile 5') & location %in% c('Urban') & sex %in% c('Male')) %>% pull(indicator)
q5_rur_f <- extracted_survey %>% filter(category=="Location & Sex & Wealth") %>%
filter(wealth %in% c('Quintile 5') & location %in% c('Rural') & sex %in% c('Female')) %>% pull(indicator)
q5_rur_m <- extracted_survey %>% filter(category=="Location & Sex & Wealth") %>%
filter(wealth %in% c('Quintile 5') & location %in% c('Rural') & sex %in% c('Male')) %>% pull(indicator)
q1_urb_f <- extracted_survey %>% filter(category=="Location & Sex & Wealth") %>%
filter(wealth %in% c('Quintile 1') & location %in% c('Urban') & sex %in% c('Female')) %>% pull(indicator)
q1_urb_m <- extracted_survey %>% filter(category=="Location & Sex & Wealth") %>%
filter(wealth %in% c('Quintile 1') & location %in% c('Urban') & sex %in% c('Male')) %>% pull(indicator)
q1_rur_f <- extracted_survey %>% filter(category=="Location & Sex & Wealth") %>%
filter(wealth %in% c('Quintile 1') & location %in% c('Rural') & sex %in% c('Female')) %>% pull(indicator)
q1_rur_m <- extracted_survey %>% filter(category=="Location & Sex & Wealth") %>%
filter(wealth %in% c('Quintile 1') & location %in% c('Rural') & sex %in% c('Male')) %>% pull(indicator)
plot_data  <- data.frame(level = c(1, 1, 2, 2, 2, 2, 3, 3, 3.5, 3.5, 3, 3, 3.5, 3.5),                      # Create example data frame
indicator = c(q1, q5, q5_urb, q5_rur, q1_urb, q1_rur, q5_urb_m, q5_urb_f, q5_rur_m, q5_rur_f, q1_urb_m, q1_urb_f, q1_rur_m, q1_rur_f),
ind_example = c(60, 95, 90, 96, 61, 50, 98, 95, 80, 90, 51, 49, 65, 58),
full_labels = c("Poorest","Richest", "Richest urban","Richest rural", "Poorest urban","Poorest rural",
"Richest urban men", "Richest urban women", "Richest rural men", "Richest rural women",
"Poorest urban men", "Poorest urban women" , "Poorest rural men", "Poorest rural women"),
# short_labels= c("Poorest","Richest", "Urban","Rural", "Urban","Rural",
#                 "Men", "Women", "Men", "Women",
#                 "Men", "Women" , "Men", "Women"),
short_labels= c("Poorest","Richest", "Urban","Rural", "Urban","Rural",
"Men", "Women", "Men", "Women",
"Men", "Women" , "Men", "Women"),
colors= c("black","black", "black","black", "black","black",
"darkorange1", "darkorange1", "darkmagenta", "darkmagenta",
"limegreen", "limegreen" , "dodgerblue3", "dodgerblue3"))
ggp <- ggplot(plot_data, aes(level, indicator, label=short_labels), colour=short_labels) +                 # Create ggplot2 plot without lines & curves
geom_point(colour=plot_data$colors)
ggp
learningg <-   ggp+
geom_segment(x = 1, #v line at level 1
y = q1,
xend = 1,
yend =q5) +
geom_segment(x = 2, #v line upper
y = q5_urb,
xend = 2,
yend =q5_rur) +
geom_segment(x = 2,
y = q1_urb,   #v line down
xend = 2,
yend =q1_rur)  +
geom_segment(x = 3,    #v line 3rd level 1st
y = q5_urb_m,
xend = 3,
yend =q5_urb_f,  color="darkorange1") +
geom_segment(x = 3.5,  #v line 3rd level 2nd
y = q5_rur_m,
xend = 3.5,
yend =q5_rur_f, color="darkmagenta") +
geom_segment(x = 3,  #v line 3rd level 4th
y = q1_urb_m,
xend = 3,
yend =q1_urb_f, color="limegreen") +
geom_segment(x = 3.5,  #v line 3rd level 4th
y = q1_rur_m,
xend = 3.5,
yend =q1_rur_f, color="dodgerblue3") +
geom_segment(x = 1,  #horizontal 1-2 up
y = q5,
xend = 2,
yend =q5) +
geom_segment(x = 2,  #horizontal 2-3 1st
y = q5_urb,
xend = 3,
yend =q5_urb, color="darkorange1") +
geom_segment(x = 2,
y = q5_rur,  #horizontal 2-3 2nd
xend = 3.5,
yend =q5_rur, color="darkmagenta")+
geom_segment(x = 1, #horizontal 1-2 down
y = q1,
xend = 2,
yend =q1)+
geom_segment(x = 2,
y = q1_urb,  #horizontal 2-3 3rd
xend = 3,
yend =q1_urb, color="limegreen")+
geom_segment(x = 2,
y = q1_rur,  #horizontal 2-3 4th
xend = 3.5,
yend =q1_rur, color="dodgerblue3")+
theme(panel.background = element_rect(fill = "gray93",
colour = "gray93",
size = 0.5, linetype = "solid"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())   +
scale_y_continuous(limits = c(0, 1))+
scale_x_continuous(n.breaks = 4, label = c("Wealth", "Location", "Sex", "Sex")) +
labs(y= "% of students reaching the minimum proficiency level \n in reading, end of primary", x="") +
geom_label_repel(aes(label = short_labels),
box.padding   = 0.95,
point.padding = 0.5,
segment.color = 'grey50')
learningg
plot_row <- plot_grid(accessg,learningg)
plot_row
# now add the title
title <- ggdraw() +
draw_label(
"Bangladesh 2019 (MICS)",
fontface = 'bold',
x = 0,
hjust = 0
) +
theme(
# add margin on the left of the drawing canvas,
# so title is aligned with left edge of first plot
plot.margin = margin(0, 0, 0, 8)
)
plot_grid(
title, plot_row,
ncol = 1,
# rel_heights values control vertical title margins
rel_heights = c(0.1, 1)
)
#doesnt work :(
ggsave("paralel_BGD2019MICS.png", width = 10, height = 6, units = "in" ,  bg = 'white')
